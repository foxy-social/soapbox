{"version":3,"file":"packs/js/modals/account-moderation-modal-8f54c96bfc3d0777ef0a.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/features/ui/components/modals/account-moderation-modal/badge-input.tsx","webpack://soapbox/./app/soapbox/features/ui/components/modals/account-moderation-modal/staff-role-picker.tsx","webpack://soapbox/./app/soapbox/features/ui/components/modals/account-moderation-modal/account-moderation-modal.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.map.js\";import React from'react';import{useIntl,defineMessages}from'react-intl';import{TagInput}from'soapbox/components/ui';import{badgeToTag,tagToBadge}from'soapbox/utils/badges';var messages=defineMessages({placeholder:{\"id\":\"badge_input.placeholder\",\"defaultMessage\":\"Enter a badge\\u2026\"}});/** Manages user badges. */var BadgeInput=function BadgeInput(_ref){var badges=_ref.badges,onChange=_ref.onChange;var intl=useIntl();var tags=badges.map(badgeToTag);var handleTagsChange=function handleTagsChange(tags){var badges=tags.map(tagToBadge);onChange(badges);};return/*#__PURE__*/_jsx(TagInput,{tags:tags,onChange:handleTagsChange,placeholder:intl.formatMessage(messages.placeholder)});};export default BadgeInput;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React,{useMemo}from'react';import{defineMessages,useIntl}from'react-intl';import{setRole}from'soapbox/actions/admin';import{SelectDropdown}from'soapbox/features/forms';import{useAppDispatch}from'soapbox/hooks';import toast from'soapbox/toast';/** Get the highest staff role associated with the account. */var getRole=function getRole(account){if(account.admin){return'admin';}else if(account.moderator){return'moderator';}else{return'user';}};var messages=defineMessages({roleUser:{\"id\":\"account_moderation_modal.roles.user\",\"defaultMessage\":\"User\"},roleModerator:{\"id\":\"account_moderation_modal.roles.moderator\",\"defaultMessage\":\"Moderator\"},roleAdmin:{\"id\":\"account_moderation_modal.roles.admin\",\"defaultMessage\":\"Admin\"},promotedToAdmin:{\"id\":\"admin.users.actions.promote_to_admin_message\",\"defaultMessage\":\"@{acct} was promoted to an admin\"},promotedToModerator:{\"id\":\"admin.users.actions.promote_to_moderator_message\",\"defaultMessage\":\"@{acct} was promoted to a moderator\"},demotedToModerator:{\"id\":\"admin.users.actions.demote_to_moderator_message\",\"defaultMessage\":\"@{acct} was demoted to a moderator\"},demotedToUser:{\"id\":\"admin.users.actions.demote_to_user_message\",\"defaultMessage\":\"@{acct} was demoted to a regular user\"}});/** Picker for setting the staff role of an account. */var StaffRolePicker=function StaffRolePicker(_ref){var account=_ref.account;var intl=useIntl();var dispatch=useAppDispatch();var roles=useMemo(function(){return{user:intl.formatMessage(messages.roleUser),moderator:intl.formatMessage(messages.roleModerator),admin:intl.formatMessage(messages.roleAdmin)};},[]);var handleRoleChange=function handleRoleChange(e){var role=e.target.value;dispatch(setRole(account.id,role)).then(function(){var message;if(role==='admin'){message=messages.promotedToAdmin;}else if(role==='moderator'&&account.admin){message=messages.demotedToModerator;}else if(role==='moderator'){message=messages.promotedToModerator;}else if(role==='user'){message=messages.demotedToUser;}if(message){toast.success(intl.formatMessage(message,{acct:account.acct}));}}).catch(function(){});};var accountRole=getRole(account);return/*#__PURE__*/_jsx(SelectDropdown,{items:roles,defaultValue:accountRole,onChange:handleRoleChange});};export default StaffRolePicker;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{defineMessages,FormattedMessage,useIntl}from'react-intl';import{verifyUser,unverifyUser,suggestUsers,unsuggestUsers,setBadges as saveBadges}from'soapbox/actions/admin';import{deactivateUserModal,deleteUserModal}from'soapbox/actions/moderation';import{useAccount}from'soapbox/api/hooks';import Account from'soapbox/components/account';import List,{ListItem}from'soapbox/components/list';import MissingIndicator from'soapbox/components/missing-indicator';import OutlineBox from'soapbox/components/outline-box';import{Button,Text,HStack,Modal,Stack,Toggle}from'soapbox/components/ui';import{useAppDispatch,useFeatures,useOwnAccount}from'soapbox/hooks';import toast from'soapbox/toast';import{isLocal}from'soapbox/utils/accounts';import{getBadges}from'soapbox/utils/badges';import BadgeInput from'./badge-input';import StaffRolePicker from'./staff-role-picker';var messages=defineMessages({userVerified:{\"id\":\"admin.users.user_verified_message\",\"defaultMessage\":\"@{acct} was verified\"},userUnverified:{\"id\":\"admin.users.user_unverified_message\",\"defaultMessage\":\"@{acct} was unverified\"},setDonorSuccess:{\"id\":\"admin.users.set_donor_message\",\"defaultMessage\":\"@{acct} was set as a donor\"},removeDonorSuccess:{\"id\":\"admin.users.remove_donor_message\",\"defaultMessage\":\"@{acct} was removed as a donor\"},userSuggested:{\"id\":\"admin.users.user_suggested_message\",\"defaultMessage\":\"@{acct} was suggested\"},userUnsuggested:{\"id\":\"admin.users.user_unsuggested_message\",\"defaultMessage\":\"@{acct} was unsuggested\"},badgesSaved:{\"id\":\"admin.users.badges_saved_message\",\"defaultMessage\":\"Custom badges updated.\"}});/** Moderator actions against accounts. */var AccountModerationModal=function AccountModerationModal(_ref){var _account$pleroma;var onClose=_ref.onClose,accountId=_ref.accountId;var intl=useIntl();var dispatch=useAppDispatch();var _useOwnAccount=useOwnAccount(),ownAccount=_useOwnAccount.account;var features=useFeatures();var _useAccount=useAccount(accountId),account=_useAccount.account;var accountBadges=account?getBadges(account):[];var _useState=useState(accountBadges),_useState2=_slicedToArray(_useState,2),badges=_useState2[0],setBadges=_useState2[1];var handleClose=function handleClose(){return onClose('ACCOUNT_MODERATION');};if(!account||!ownAccount){return/*#__PURE__*/_jsx(Modal,{onClose:handleClose},void 0,/*#__PURE__*/_jsx(MissingIndicator,{}));}var handleAdminFE=function handleAdminFE(){window.open(\"/pleroma/admin/#/users/\".concat(account.id,\"/\"),'_blank');};var handleVerifiedChange=function handleVerifiedChange(e){var checked=e.target.checked;var message=checked?messages.userVerified:messages.userUnverified;var action=checked?verifyUser:unverifyUser;dispatch(action(account.id)).then(function(){return toast.success(intl.formatMessage(message,{acct:account.acct}));}).catch(function(){});};var handleSuggestedChange=function handleSuggestedChange(e){var checked=e.target.checked;var message=checked?messages.userSuggested:messages.userUnsuggested;var action=checked?suggestUsers:unsuggestUsers;dispatch(action([account.id])).then(function(){return toast.success(intl.formatMessage(message,{acct:account.acct}));}).catch(function(){});};var handleDeactivate=function handleDeactivate(){dispatch(deactivateUserModal(intl,account.id));};var handleDelete=function handleDelete(){dispatch(deleteUserModal(intl,account.id));};var handleSaveBadges=function handleSaveBadges(){dispatch(saveBadges(account.id,accountBadges,badges)).then(function(){return toast.success(intl.formatMessage(messages.badgesSaved));}).catch(function(){});};return/*#__PURE__*/_jsx(Modal,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.title\",defaultMessage:\"Moderate @{acct}\",values:{acct:account.acct}}),onClose:handleClose},void 0,/*#__PURE__*/_jsx(Stack,{space:4},void 0,/*#__PURE__*/_jsx(OutlineBox,{},void 0,/*#__PURE__*/_jsx(Account,{account:account,showProfileHoverCard:false,withLinkToProfile:false,hideActions:true})),/*#__PURE__*/_jsx(List,{},void 0,ownAccount.admin&&isLocal(account)&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.fields.account_role\",defaultMessage:\"Staff level\"})},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"w-auto\"},void 0,/*#__PURE__*/_jsx(StaffRolePicker,{account:account}))),/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.fields.verified\",defaultMessage:\"Verified account\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:account.verified,onChange:handleVerifiedChange})),features.suggestionsV2&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.fields.suggested\",defaultMessage:\"Suggested in people to follow\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:((_account$pleroma=account.pleroma)===null||_account$pleroma===void 0?void 0:_account$pleroma.is_suggested)===true,onChange:handleSuggestedChange})),/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.fields.badges\",defaultMessage:\"Custom badges\"})},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"grow\"},void 0,/*#__PURE__*/_jsx(HStack,{className:\"w-full\",alignItems:\"center\",space:2},void 0,/*#__PURE__*/_jsx(BadgeInput,{badges:badges,onChange:setBadges}),/*#__PURE__*/_jsx(Button,{onClick:handleSaveBadges},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"save\",defaultMessage:\"Save\"})))))),/*#__PURE__*/_jsx(List,{},void 0,/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.fields.deactivate\",defaultMessage:\"Deactivate account\"}),onClick:handleDeactivate}),/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.fields.delete\",defaultMessage:\"Delete account\"}),onClick:handleDelete})),/*#__PURE__*/_jsx(Text,{theme:\"subtle\",size:\"xs\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.info.id\",defaultMessage:\"ID: {id}\",values:{id:account.id}})),features.adminFE&&/*#__PURE__*/_jsx(HStack,{justifyContent:\"center\"},void 0,/*#__PURE__*/_jsx(Button,{icon:require('@tabler/icons/external-link.svg'),size:\"sm\",theme:\"secondary\",onClick:handleAdminFE},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_moderation_modal.admin_fe\",defaultMessage:\"Open in AdminFE\"})))));};export default AccountModerationModal;"],"names":["messages","placeholder","_ref","badges","onChange","intl","useIntl","tags","map","formatMessage","roleUser","roleModerator","roleAdmin","promotedToAdmin","promotedToModerator","demotedToModerator","demotedToUser","account","dispatch","roles","useMemo","user","moderator","admin","accountRole","getRole","items","defaultValue","e","role","target","value","id","then","message","toast","acct","catch","userVerified","userUnverified","setDonorSuccess","removeDonorSuccess","userSuggested","userUnsuggested","badgesSaved","_account$pleroma","onClose","accountId","ownAccount","features","accountBadges","_useState","useState","_useState2","setBadges","handleClose","title","defaultMessage","values","space","showProfileHoverCard","withLinkToProfile","hideActions","label","className","checked","verified","action","suggestionsV2","pleroma","is_suggested","alignItems","onClick","theme","size","adminFE","justifyContent","icon","window","open","concat"],"sourceRoot":""}