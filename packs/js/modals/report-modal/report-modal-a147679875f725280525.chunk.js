"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[219],{1355:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var a,n,o=r(2111),i=r(1202),s=r(1188),d=r(1),u=r(2121),c=r(2122),l=r(2142),f=r(51),g=r(180),m=r(83),p=r(36),v=r(455),h=r(775),Z=r(100),b=r(225),y=r(2),k=r(92),M=r(3),w=r(199),T=(0,u.vU)({accountEntity:{id:"report.confirmation.entity.account",defaultMessage:"account"},groupEntity:{id:"report.confirmation.entity.group",defaultMessage:"group"},title:{id:"report.confirmation.title",defaultMessage:"Thanks for submitting your report."},content:{id:"report.confirmation.content",defaultMessage:"If we find that this {entity} is violating the {link} we will take further action on the matter."}}),x=(0,i.Z)(l.Z,{id:"shared.tos",defaultMessage:"Terms of Service"}),E=function(){var e,t=(0,c.Z)(),r=(0,M.CG)((function(e){return(0,w.UX)(e).get("links")})),a=(0,M.CG)((function(e){return e.reports.new.entityType}))===g.JG.GROUP?t.formatMessage(T.groupEntity):t.formatMessage(T.accountEntity);return(0,i.Z)(y.Kq,{space:1},void 0,(0,i.Z)(y.xv,{weight:"semibold",tag:"h1",size:"xl"},void 0,t.formatMessage(T.title)),(0,i.Z)(y.xv,{},void 0,t.formatMessage(T.content,{entity:a,link:r.get("termsOfService")?(e=r.get("termsOfService"),(0,i.Z)("a",{href:e,target:"_blank",className:"text-primary-600 hover:text-primary-800 hover:underline dark:text-accent-blue dark:hover:text-accent-blue"},void 0,x)):x})))},C=(r(5),r(753)),G=r(723),O=(r(28),r(31),r(0),r(12),r(29),r(821)),S=r.n(O),A=r(452),N=r(81),_=function(e){var t,r,a,n=e.id,o=e.disabled,s=(0,M.TL)(),d=(0,M.CG)((function(e){return e.statuses.get(n)})),u=(0,M.CG)((function(e){return e.reports.new.status_ids.includes(n)}));if(!d||d.reblog)return null;if(d.media_attachments.size>0)if(d.media_attachments.some((function(e){return"unknown"===e.type})));else if("video"===(null===(r=d.media_attachments.get(0))||void 0===r?void 0:r.type)){var c=d.media_attachments.get(0);c&&(t=(0,i.Z)(A.Z,{fetchComponent:N.nk},void 0,(function(e){return(0,i.Z)(e,{preview:c.preview_url,blurhash:c.blurhash,src:c.url,alt:c.description,aspectRatio:c.meta.getIn(["original","aspect"]),width:239,height:110,inline:!0,sensitive:d.sensitive,onOpenVideo:S()})})))}else if("audio"===(null===(a=d.media_attachments.get(0))||void 0===a?void 0:a.type)){var l=d.media_attachments.get(0);l&&(t=(0,i.Z)(A.Z,{fetchComponent:N.Bb},void 0,(function(e){return(0,i.Z)(e,{src:l.url,alt:l.description,inline:!0,sensitive:d.sensitive,onOpenAudio:S()})})))}else t=(0,i.Z)(A.Z,{fetchComponent:N.ew},void 0,(function(e){return(0,i.Z)(e,{media:d.media_attachments,sensitive:d.sensitive,height:110,onOpenMedia:S()})}));return(0,i.Z)("div",{className:"status-check-box"},void 0,(0,i.Z)("div",{className:"status-check-box__status"},void 0,(0,i.Z)(b.Z,{status:d}),t),(0,i.Z)("div",{className:"status-check-box-toggle"},void 0,(0,i.Z)(y.ZD,{checked:u,onChange:function(e){return s((0,g.cm)(n,e.target.checked))},disabled:o})))},R=r(111),H=(0,u.vU)({addAdditionalStatuses:{id:"report.otherActions.addAdditional",defaultMessage:"Would you like to add additional statuses to this report?"},addMore:{id:"report.otherActions.addMore",defaultMessage:"Add more"},furtherActions:{id:"report.otherActions.furtherActions",defaultMessage:"Further actions:"},hideAdditonalStatuses:{id:"report.otherActions.hideAdditional",defaultMessage:"Hide additional statuses"},otherStatuses:{id:"report.otherActions.otherStatuses",defaultMessage:"Include other statuses?"}}),U=function(e){var t=e.account,a=(0,M.TL)(),n=(0,M.hz)(),s=(0,c.Z)(),u=(0,M.CG)((function(e){return(0,C.OrderedSet)(e.timelines.get("account:".concat(t.id,":with_replies")).items).union(e.reports.new.status_ids)})),f=(0,M.CG)((function(e){return e.reports.new.block})),m=(0,M.CG)((function(e){return e.reports.new.forward})),p=(0,R.Q1)(t)&&n.federating,v=(0,M.CG)((function(e){return e.reports.new.isSubmitting})),h=(0,d.useState)(!1),Z=(0,o.Z)(h,2),b=Z[0],k=Z[1];return(0,d.useEffect)((function(){a((0,G.j)())}),[]),(0,i.Z)(y.Kq,{space:4},void 0,n.reportMultipleStatuses&&(0,i.Z)(y.Kq,{space:2},void 0,(0,i.Z)(y.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,s.formatMessage(H.otherStatuses)),(0,i.Z)(y.cw,{labelText:s.formatMessage(H.addAdditionalStatuses)},void 0,b?(0,i.Z)(y.Kq,{space:2},void 0,(0,i.Z)("div",{className:"divide-y divide-solid divide-gray-200 dark:divide-gray-800"},void 0,u.map((function(e){return(0,i.Z)(_,{id:e},e)}))),(0,i.Z)("div",{},void 0,(0,i.Z)(y.zx,{icon:r(822),theme:"tertiary",size:"sm",onClick:function(){return k(!1)}},void 0,s.formatMessage(H.hideAdditonalStatuses)))):(0,i.Z)(y.zx,{icon:r(179),theme:"tertiary",size:"sm",onClick:function(){return k(!0)}},void 0,s.formatMessage(H.addMore)))),(0,i.Z)(y.Kq,{space:2},void 0,(0,i.Z)(y.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,s.formatMessage(H.furtherActions)),(0,i.Z)(y.cw,{labelText:(0,i.Z)(l.Z,{id:"report.block_hint",defaultMessage:"Do you also want to block this account?"})},void 0,(0,i.Z)(y.Ug,{space:2,alignItems:"center"},void 0,(0,i.Z)(y.ZD,{checked:f,onChange:function(e){a((0,g.LG)(e.target.checked))},id:"report-block"}),(0,i.Z)(y.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-block"},void 0,(0,i.Z)(l.Z,{id:"report.block",defaultMessage:"Block {target}",values:{target:"@".concat(t.acct)}})))),p&&(0,i.Z)(y.cw,{labelText:(0,i.Z)(l.Z,{id:"report.forward_hint",defaultMessage:"The account is from another server. Send a copy of the report there as well?"})},void 0,(0,i.Z)(y.Ug,{space:2,alignItems:"center"},void 0,(0,i.Z)(y.ZD,{checked:m,onChange:function(e){a((0,g.$p)(e.target.checked))},id:"report-forward",disabled:v}),(0,i.Z)(y.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-forward"},void 0,(0,i.Z)(l.Z,{id:"report.forward",defaultMessage:"Forward to {target}",values:{target:(0,R.ge)(t)}}))))))},z=(r(9),r(702)),J=(0,u.vU)({placeholder:{id:"report.placeholder",defaultMessage:"Additional comments"},reasonForReporting:{id:"report.reason.title",defaultMessage:"Reason for reporting"}}),q=function(){var e=(0,M.TL)(),t=(0,c.Z)(),r=(0,d.useRef)(null),a=(0,d.useState)(!1),n=(0,o.Z)(a,2),s=n[0],u=n[1],l=(0,d.useState)(!0),f=(0,o.Z)(l,2),m=f[0],p=f[1],v=(0,M.CG)((function(e){return e.reports.new.entityType})),h=(0,M.CG)((function(e){return e.reports.new.comment})),Z=(0,M.CG)((function(e){return e.rules.items})),b=(0,M.CG)((function(e){return e.reports.new.rule_ids})),k=Z.length>0;return(0,d.useEffect)((function(){e((0,G.j)())}),[]),(0,d.useEffect)((function(){Z.length>0&&r.current&&r.current.clientHeight<=385&&u(!0)}),[Z,r.current]),(0,i.Z)(y.Kq,{space:4},void 0,k&&(0,i.Z)(y.Kq,{space:2},void 0,(0,i.Z)(y.xv,{size:"xl",weight:"semibold",tag:"h1"},void 0,t.formatMessage(J.reasonForReporting)),(0,i.Z)("div",{className:"relative"},void 0,d.createElement("div",{style:{maxHeight:385},className:"-space-y-px overflow-y-auto rounded-lg",onScroll:function(){if(r.current){var e=r.current,t=e.scrollTop,a=e.scrollHeight,n=e.clientHeight;u(t+n>a-24),p(t<24)}},ref:r},Z.filter((function(e){var t="content";switch(v){case g.JG.ACCOUNT:t="account";break;case g.JG.STATUS:case g.JG.CHAT_MESSAGE:t="content";break;case g.JG.GROUP:t="group";break;default:t="content"}return!e.rule_type||e.rule_type===t})).map((function(t,r){var a=b.includes(String(t.id));return(0,i.Z)("button",{"data-testid":"rule-".concat(t.id),onClick:function(){return e((0,g.Nr)(t.id))},className:(0,z.default)({"relative border border-solid border-gray-200 dark:border-gray-800 hover:bg-gray-100 dark:hover:bg-primary-800/30 text-start w-full p-4 flex justify-between items-center cursor-pointer":!0,"rounded-tl-lg rounded-tr-lg":0===r,"rounded-bl-lg rounded-br-lg":r===Z.length-1,"bg-gray-200 hover:bg-gray-200 dark:bg-primary-800/50":a})},r,(0,i.Z)(y.Kq,{className:"mr-3"},void 0,(0,i.Z)(y.xv,{tag:"span",size:"sm",weight:"medium",theme:a?"primary":"default"},void 0,t.text),(0,i.Z)(y.xv,{tag:"span",theme:"muted",size:"sm"},void 0,t.subtext)),(0,i.Z)("input",{name:"reason",type:"checkbox",value:t.id,checked:a,readOnly:!0,className:"h-4 w-4 rounded border-2 border-gray-300 text-primary-600 checked:bg-primary-500 focus:ring-primary-500 dark:border-gray-800 dark:bg-gray-900 dark:checked:bg-primary-500 dark:focus:ring-primary-500"}))}))),(0,i.Z)("div",{className:(0,z.default)("pointer-events-none absolute inset-x-0 top-0 flex justify-center rounded-t-lg bg-gradient-to-b from-white pb-12 pt-8 transition-opacity duration-500 dark:from-gray-900",{"opacity-0":m,"opacity-100":!m})}),(0,i.Z)("div",{className:(0,z.default)("pointer-events-none absolute inset-x-0 bottom-0 flex justify-center rounded-b-lg bg-gradient-to-t from-white pb-8 pt-12 transition-opacity duration-500 dark:from-gray-900",{"opacity-0":s,"opacity-100":!s})}))),(0,i.Z)(y.cw,{labelText:t.formatMessage(J.placeholder)},void 0,(0,i.Z)(y.gx,{placeholder:t.formatMessage(J.placeholder),value:h,onChange:function(t){e((0,g.Ck)(t.target.value))}})))},W=(0,u.vU)({blankslate:{id:"report.reason.blankslate",defaultMessage:"You have removed all statuses from being selected."},done:{id:"report.done",defaultMessage:"Done"},next:{id:"report.next",defaultMessage:"Next"},submit:{id:"report.submit",defaultMessage:"Submit"},reportContext:{id:"report.chatMessage.context",defaultMessage:"When reporting a userâ€™s message, the five messages before and five messages after the one selected will be passed along to our moderation team for context."},reportMessage:{id:"report.chatMessage.title",defaultMessage:"Report message"},reportGroup:{id:"report.group.title",defaultMessage:"Report Group"},cancel:{id:"common.cancel",defaultMessage:"Cancel"},previous:{id:"report.previous",defaultMessage:"Previous"}});!function(e){e.ONE="ONE",e.TWO="TWO",e.THREE="THREE"}(n||(n={}));var K=(a={},(0,s.Z)(a,g.JG.ACCOUNT,{ONE:q,TWO:U,THREE:E}),(0,s.Z)(a,g.JG.CHAT_MESSAGE,{ONE:q,TWO:U,THREE:E}),(0,s.Z)(a,g.JG.STATUS,{ONE:q,TWO:U,THREE:E}),(0,s.Z)(a,g.JG.GROUP,{ONE:q,TWO:null,THREE:E}),a),I=function(e){var t=e.statusId,r=(0,M.CG)((function(e){return e.statuses.get(t)}));return r?(0,i.Z)(y.Kq,{space:2,className:"rounded-lg bg-gray-100 p-4 dark:bg-gray-800"},void 0,(0,i.Z)(k.Z,{id:r.account,showProfileHoverCard:!1,withLinkToProfile:!1,timestamp:r.created_at,hideActions:!0}),(0,i.Z)(b.Z,{status:r,collapsable:!0}),r.media_attachments.size>0&&(0,i.Z)(v.Z,{media:r.media_attachments,sensitive:r.sensitive})):null},P=function(e){var t=e.onClose,a=(0,M.TL)(),s=(0,c.Z)(),u=(0,M.CG)((function(e){return e.reports.new.account_id})),v=(0,p.mA)(u||void 0).account,b=(0,M.CG)((function(e){return e.reports.new.entityType})),k=(0,M.CG)((function(e){return e.reports.new.block})),w=(0,M.CG)((function(e){return e.reports.new.isSubmitting})),T=(0,M.CG)((function(e){return e.rules.items})),x=(0,M.CG)((function(e){return e.reports.new.rule_ids})),E=(0,M.CG)((function(e){return e.reports.new.status_ids})),C=(0,M.CG)((function(e){return e.reports.new.chat_message})),G=(0,M.CG)((function(e){return e.reports.new.group})),O=T.length>0,S=b===g.JG.ACCOUNT,A=b===g.JG.STATUS,N=b===g.JG.GROUP,_=(0,d.useState)(n.ONE),R=(0,o.Z)(_,2),H=R[0],U=R[1],z=function(){a((0,g.ZD)()).then((function(){return U(n.THREE)})).catch((function(e){return a((0,g.rC)(e))})),k&&v&&a((0,f.Gy)(v.id))},J=(0,d.useCallback)((function(){return 0===E.size?(0,i.Z)("div",{className:"flex w-full items-center justify-center rounded-lg bg-gray-100 p-4 dark:bg-gray-800"},void 0,(0,i.Z)(y.xv,{theme:"muted"},void 0,s.formatMessage(W.blankslate))):(0,i.Z)(I,{statusId:E.first()})}),[E.size]),q=(0,d.useMemo)((function(){return H===n.ONE?s.formatMessage(W.cancel):s.formatMessage(W.previous)}),[H]),P=(0,d.useMemo)((function(){switch(H){case n.ONE:return N?s.formatMessage(W.submit):s.formatMessage(W.next);case n.TWO:return N?s.formatMessage(W.done):s.formatMessage(W.submit);case n.THREE:return s.formatMessage(W.done);default:return s.formatMessage(W.next)}}),[H,N]),D=(0,d.useMemo)((function(){return H!==n.THREE&&(w||O&&x.isEmpty()||A&&0===E.size)}),[H,w,O,x,E.size,A]),F=(0,d.useCallback)((function(){switch(H){case n.ONE:return.33;case n.TWO:return.66;case n.THREE:return 1;default:return 0}}),[H]);if((0,d.useEffect)((function(){null!=v&&v.id&&a((0,m.Cn)(v.id,{withReplies:!0,maxId:null}))}),[null==v?void 0:v.id]),!v)return null;var L=K[b][H];return(0,i.Z)(y.u_,{title:function(){switch(b){case g.JG.CHAT_MESSAGE:return s.formatMessage(W.reportMessage);case g.JG.GROUP:return s.formatMessage(W.reportGroup);default:return(0,i.Z)(l.Z,{id:"report.target",defaultMessage:"Reporting {target}",values:{target:(0,i.Z)("strong",{},void 0,"@",null==v?void 0:v.acct)}})}}(),onClose:t,cancelText:q,cancelAction:H===n.THREE?void 0:function(){switch(H){case n.ONE:t();break;case n.TWO:U(n.ONE)}},confirmationAction:function(){switch(H){case n.ONE:N?z():U(n.TWO);break;case n.TWO:N?(a((0,g.rq)()),t()):z();break;case n.THREE:a((0,g.rq)()),t()}},confirmationText:P,confirmationDisabled:D,skipFocus:!0},void 0,(0,i.Z)(y.Kq,{space:4},void 0,(0,i.Z)(y.ko,{progress:F()}),H!==n.THREE&&!S&&function(){switch(b){case g.JG.STATUS:return J();case g.JG.CHAT_MESSAGE:return function(){if(v)return(0,i.Z)(y.Kq,{space:4},void 0,(0,i.Z)(y.Ug,{alignItems:"center",space:4,className:"rounded-md border border-solid border-gray-400 p-4 dark:border-2 dark:border-gray-800"},void 0,(0,i.Z)("div",{},void 0,(0,i.Z)(y.qE,{src:v.avatar,className:"h-8 w-8"})),(0,i.Z)("div",{className:"grow rounded-md bg-gray-200 p-4 dark:bg-primary-800"},void 0,(0,i.Z)(y.xv,{dangerouslySetInnerHTML:{__html:null==C?void 0:C.content}}))),(0,i.Z)(Z.Z,{},void 0,(0,i.Z)(Z.H,{label:(0,i.Z)(y.JO,{src:r(451),className:"text-gray-600"})},void 0,(0,i.Z)(y.xv,{size:"sm"},void 0,s.formatMessage(W.reportContext)))))}();case g.JG.GROUP:return H===n.TWO?null:function(){if(G)return(0,i.Z)(h.Z,{group:G})}();default:return null}}(),L&&(0,i.Z)(L,{account:v})))}}}]);
//# sourceMappingURL=report-modal-a147679875f725280525.chunk.js.map