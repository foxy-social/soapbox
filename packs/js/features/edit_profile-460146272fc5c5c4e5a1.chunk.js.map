{"version":3,"file":"packs/js/features/edit_profile-460146272fc5c5c4e5a1.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/features/edit-profile/index.tsx"],"sourcesContent":["import\"core-js/modules/es.object.keys.js\";import\"core-js/modules/es.symbol.js\";import\"core-js/modules/es.object.get-own-property-descriptor.js\";import\"core-js/modules/web.dom-collections.for-each.js\";import\"core-js/modules/es.object.get-own-property-descriptors.js\";import\"core-js/modules/es.object.define-properties.js\";import\"core-js/modules/es.object.define-property.js\";import _extends from\"@babel/runtime/helpers/esm/extends\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/esm/toConsumableArray\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.promise.js\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.string.starts-with.js\";import\"core-js/modules/es.array.push.js\";import\"core-js/modules/es.array.iterator.js\";import\"core-js/modules/es.string.iterator.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import\"core-js/modules/es.array.concat.js\";import\"core-js/modules/es.array.splice.js\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useState,useEffect}from'react';import{defineMessages,useIntl,FormattedMessage}from'react-intl';import{updateNotificationSettings}from'soapbox/actions/accounts';import{patchMe}from'soapbox/actions/me';import BirthdayInput from'soapbox/components/birthday-input';import List,{ListItem}from'soapbox/components/list';import{Button,Column,Form,FormActions,FormGroup,HStack,Input,Streamfield,Textarea,Toggle}from'soapbox/components/ui';import{useAppDispatch,useOwnAccount,useFeatures,useInstance,useAppSelector}from'soapbox/hooks';import{useImageField}from'soapbox/hooks/forms';import toast from'soapbox/toast';import{isDefaultAvatar,isDefaultHeader}from'soapbox/utils/accounts';import AvatarPicker from'./components/avatar-picker';import HeaderPicker from'./components/header-picker';var nonDefaultAvatar=function nonDefaultAvatar(url){return url&&isDefaultAvatar(url)?undefined:url;};var nonDefaultHeader=function nonDefaultHeader(url){return url&&isDefaultHeader(url)?undefined:url;};/**\n * Whether the user is hiding their follows and/or followers.\n * Pleroma's config is granular, but we simplify it into one setting.\n */var hidesNetwork=function hidesNetwork(_ref){var pleroma=_ref.pleroma;return Boolean((pleroma===null||pleroma===void 0?void 0:pleroma.hide_followers)&&(pleroma===null||pleroma===void 0?void 0:pleroma.hide_follows)&&(pleroma===null||pleroma===void 0?void 0:pleroma.hide_followers_count)&&(pleroma===null||pleroma===void 0?void 0:pleroma.hide_follows_count));};var messages=defineMessages({heading:{\"id\":\"column.edit_profile\",\"defaultMessage\":\"Edit profile\"},header:{\"id\":\"edit_profile.header\",\"defaultMessage\":\"Edit Profile\"},metaFieldLabel:{\"id\":\"edit_profile.fields.meta_fields.label_placeholder\",\"defaultMessage\":\"Label\"},metaFieldContent:{\"id\":\"edit_profile.fields.meta_fields.content_placeholder\",\"defaultMessage\":\"Content\"},success:{\"id\":\"edit_profile.success\",\"defaultMessage\":\"Profile saved!\"},error:{\"id\":\"edit_profile.error\",\"defaultMessage\":\"Profile update failed\"},bioPlaceholder:{\"id\":\"edit_profile.fields.bio_placeholder\",\"defaultMessage\":\"Tell us about yourself.\"},displayNamePlaceholder:{\"id\":\"edit_profile.fields.display_name_placeholder\",\"defaultMessage\":\"Name\"},websitePlaceholder:{\"id\":\"edit_profile.fields.website_placeholder\",\"defaultMessage\":\"Display a Link\"},locationPlaceholder:{\"id\":\"edit_profile.fields.location_placeholder\",\"defaultMessage\":\"Location\"},cancel:{\"id\":\"common.cancel\",\"defaultMessage\":\"Cancel\"}});/**\n * Profile metadata `name` and `value`.\n * (By default, max 4 fields and 255 characters per property/value)\n */ /** Convert an account into an update_credentials request object. */var accountToCredentials=function accountToCredentials(account){var _account$source$note,_account$source,_account$source$field,_account$source2,_account$pleroma,_account$pleroma$noti,_account$pleroma2,_account$pleroma$birt,_account$pleroma3;var hideNetwork=hidesNetwork(account);return{discoverable:account.discoverable,bot:account.bot,display_name:account.display_name,note:(_account$source$note=(_account$source=account.source)===null||_account$source===void 0?void 0:_account$source.note)!==null&&_account$source$note!==void 0?_account$source$note:'',locked:account.locked,fields_attributes:_toConsumableArray((_account$source$field=(_account$source2=account.source)===null||_account$source2===void 0?void 0:_account$source2.fields)!==null&&_account$source$field!==void 0?_account$source$field:[]),stranger_notifications:((_account$pleroma=account.pleroma)===null||_account$pleroma===void 0?void 0:(_account$pleroma$noti=_account$pleroma.notification_settings)===null||_account$pleroma$noti===void 0?void 0:_account$pleroma$noti.block_from_strangers)===true,accepts_email_list:((_account$pleroma2=account.pleroma)===null||_account$pleroma2===void 0?void 0:_account$pleroma2.accepts_email_list)===true,hide_followers:hideNetwork,hide_follows:hideNetwork,hide_followers_count:hideNetwork,hide_follows_count:hideNetwork,website:account.website,location:account.location,birthday:(_account$pleroma$birt=(_account$pleroma3=account.pleroma)===null||_account$pleroma3===void 0?void 0:_account$pleroma3.birthday)!==null&&_account$pleroma$birt!==void 0?_account$pleroma$birt:undefined};};var ProfileField=function ProfileField(_ref2){var value=_ref2.value,onChange=_ref2.onChange;var intl=useIntl();var handleChange=function handleChange(key){return function(e){onChange(_objectSpread(_objectSpread({},value),{},_defineProperty({},key,e.currentTarget.value)));};};return/*#__PURE__*/_jsx(HStack,{space:2,grow:true},void 0,/*#__PURE__*/_jsx(Input,{type:\"text\",outerClassName:\"w-2/5 grow\",value:value.name,onChange:handleChange('name'),placeholder:intl.formatMessage(messages.metaFieldLabel)}),/*#__PURE__*/_jsx(Input,{type:\"text\",outerClassName:\"w-3/5 grow\",value:value.value,onChange:handleChange('value'),placeholder:intl.formatMessage(messages.metaFieldContent)}));};/** Edit profile page. */var EditProfile=function EditProfile(){var _useAppSelector;var intl=useIntl();var dispatch=useAppDispatch();var instance=useInstance();var _useOwnAccount=useOwnAccount(),account=_useOwnAccount.account;var features=useFeatures();var maxFields=instance.pleroma.getIn(['metadata','fields_limits','max_fields'],4);var attachmentTypes=(_useAppSelector=useAppSelector(function(state){return state.instance.configuration.getIn(['media_attachments','supported_mime_types']);}))===null||_useAppSelector===void 0?void 0:_useAppSelector.filter(function(type){return type.startsWith('image/');}).toArray().join(',');var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setLoading=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),muteStrangers=_useState6[0],setMuteStrangers=_useState6[1];var avatar=useImageField({maxPixels:400*400,preview:nonDefaultAvatar(account===null||account===void 0?void 0:account.avatar)});var header=useImageField({maxPixels:1920*1080,preview:nonDefaultHeader(account===null||account===void 0?void 0:account.header)});useEffect(function(){if(account){var _account$pleroma4,_account$pleroma4$not;var credentials=accountToCredentials(account);var strangerNotifications=((_account$pleroma4=account.pleroma)===null||_account$pleroma4===void 0?void 0:(_account$pleroma4$not=_account$pleroma4.notification_settings)===null||_account$pleroma4$not===void 0?void 0:_account$pleroma4$not.block_from_strangers)===true;setData(credentials);setMuteStrangers(strangerNotifications);}},[account===null||account===void 0?void 0:account.id]);/** Set a single key in the request data. */var updateData=function updateData(key,value){setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},key,value));});};var handleSubmit=function handleSubmit(event){var _params$fields_attrib;var promises=[];var params=_objectSpread({},data);if(((_params$fields_attrib=params.fields_attributes)===null||_params$fields_attrib===void 0?void 0:_params$fields_attrib.length)===0)params.fields_attributes=[{name:'',value:''}];if(header.file!==undefined)params.header=header.file||'';if(avatar.file!==undefined)params.avatar=avatar.file||'';promises.push(dispatch(patchMe(params,true)));if(features.muteStrangers){promises.push(dispatch(updateNotificationSettings({block_from_strangers:muteStrangers})).catch(console.error));}setLoading(true);Promise.all(promises).then(function(){setLoading(false);toast.success(intl.formatMessage(messages.success));}).catch(function(){setLoading(false);toast.error(intl.formatMessage(messages.error));});event.preventDefault();};var handleCheckboxChange=function handleCheckboxChange(key){return function(e){updateData(key,e.target.checked);};};var handleTextChange=function handleTextChange(key){return function(e){updateData(key,e.target.value);};};var handleBirthdayChange=function handleBirthdayChange(date){updateData('birthday',date);};var handleHideNetworkChange=function handleHideNetworkChange(e){var hide=e.target.checked;setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{hide_followers:hide,hide_follows:hide,hide_followers_count:hide,hide_follows_count:hide});});};var handleFieldsChange=function handleFieldsChange(fields){updateData('fields_attributes',fields);};var handleAddField=function handleAddField(){var oldFields=data.fields_attributes||[];var fields=[].concat(_toConsumableArray(oldFields),[{name:'',value:''}]);updateData('fields_attributes',fields);};var handleRemoveField=function handleRemoveField(i){var oldFields=data.fields_attributes||[];var fields=_toConsumableArray(oldFields);fields.splice(i,1);updateData('fields_attributes',fields);};return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.header)},void 0,/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"relative mb-12 flex\"},void 0,/*#__PURE__*/React.createElement(HeaderPicker,_extends({accept:attachmentTypes,disabled:isLoading},header)),/*#__PURE__*/React.createElement(AvatarPicker,_extends({className:\"!sm:left-6 !left-4 !translate-x-0\",accept:attachmentTypes,disabled:isLoading},avatar))),/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.display_name_label\",defaultMessage:\"Display name\"})},void 0,/*#__PURE__*/_jsx(Input,{type:\"text\",value:data.display_name,onChange:handleTextChange('display_name'),placeholder:intl.formatMessage(messages.displayNamePlaceholder)})),features.birthdays&&/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.birthday_label\",defaultMessage:\"Birthday\"})},void 0,/*#__PURE__*/_jsx(BirthdayInput,{value:data.birthday,onChange:handleBirthdayChange})),features.accountLocation&&/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.location_label\",defaultMessage:\"Location\"})},void 0,/*#__PURE__*/_jsx(Input,{type:\"text\",value:data.location,onChange:handleTextChange('location'),placeholder:intl.formatMessage(messages.locationPlaceholder)})),features.accountWebsite&&/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.website_label\",defaultMessage:\"Website\"})},void 0,/*#__PURE__*/_jsx(Input,{type:\"text\",value:data.website,onChange:handleTextChange('website'),placeholder:intl.formatMessage(messages.websitePlaceholder)})),/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.bio_label\",defaultMessage:\"Bio\"})},void 0,/*#__PURE__*/_jsx(Textarea,{value:data.note,onChange:handleTextChange('note'),autoComplete:\"off\",placeholder:intl.formatMessage(messages.bioPlaceholder)})),/*#__PURE__*/_jsx(List,{},void 0,features.followRequests&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.locked_label\",defaultMessage:\"Lock account\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.locked\",defaultMessage:\"Requires you to manually approve followers\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:data.locked,onChange:handleCheckboxChange('locked')})),features.hideNetwork&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.hide_network_label\",defaultMessage:\"Hide network\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.hide_network\",defaultMessage:\"Who you follow and who follows you will not be shown on your profile\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:account?data.hide_followers&&data.hide_follows&&data.hide_followers_count&&data.hide_follows_count:false,onChange:handleHideNetworkChange})),features.bots&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.bot_label\",defaultMessage:\"This is a bot account\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.bot\",defaultMessage:\"This account mainly performs automated actions and might not be monitored\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:data.bot,onChange:handleCheckboxChange('bot')})),features.muteStrangers&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.stranger_notifications_label\",defaultMessage:\"Block notifications from strangers\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.stranger_notifications\",defaultMessage:\"Only show notifications from people you follow\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:muteStrangers,onChange:function onChange(e){return setMuteStrangers(e.target.checked);}})),features.profileDirectory&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.discoverable_label\",defaultMessage:\"Allow account discovery\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.discoverable\",defaultMessage:\"Display account in profile directory and allow indexing by external services\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:data.discoverable,onChange:handleCheckboxChange('discoverable')})),features.emailList&&/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.accepts_email_list_label\",defaultMessage:\"Subscribe to newsletter\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.accepts_email_list\",defaultMessage:\"Opt-in to news and marketing updates.\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:data.accepts_email_list,onChange:handleCheckboxChange('accepts_email_list')}))),features.profileFields&&/*#__PURE__*/_jsx(Streamfield,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.fields.meta_fields_label\",defaultMessage:\"Profile fields\"}),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.hints.meta_fields\",defaultMessage:\"You can have up to {count, plural, one {# custom field} other {# custom fields}} displayed on your profile.\",values:{count:maxFields}}),values:data.fields_attributes||[],onChange:handleFieldsChange,onAddItem:handleAddField,onRemoveItem:handleRemoveField,component:ProfileField,maxItems:maxFields}),/*#__PURE__*/_jsx(FormActions,{},void 0,/*#__PURE__*/_jsx(Button,{to:\"/settings\",theme:\"tertiary\"},void 0,intl.formatMessage(messages.cancel)),/*#__PURE__*/_jsx(Button,{theme:\"primary\",type:\"submit\",disabled:isLoading},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"edit_profile.save\",defaultMessage:\"Save\"})))));};export default EditProfile;"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","nonDefaultHeader","url","undefined","messages","heading","header","metaFieldLabel","metaFieldContent","success","error","bioPlaceholder","displayNamePlaceholder","websitePlaceholder","locationPlaceholder","cancel","ProfileField","_ref2","value","onChange","intl","handleChange","e","currentTarget","space","grow","type","outerClassName","name","placeholder","formatMessage","_useAppSelector","dispatch","instance","account","features","maxFields","pleroma","getIn","attachmentTypes","state","configuration","startsWith","toArray","join","_useState","useState","_useState2","isLoading","setLoading","_useState3","_useState4","data","setData","_useState5","_useState6","muteStrangers","setMuteStrangers","avatar","maxPixels","preview","useEffect","_account$pleroma4","_account$pleroma4$not","credentials","_account$source$note","_account$source","_account$source$field","_account$source2","_account$pleroma","_account$pleroma$noti","_account$pleroma2","_account$pleroma$birt","_account$pleroma3","hideNetwork","Boolean","hide_followers","hide_follows","hide_followers_count","hide_follows_count","discoverable","bot","display_name","note","locked","fields_attributes","fields","stranger_notifications","notification_settings","block_from_strangers","accepts_email_list","website","location","birthday","accountToCredentials","strangerNotifications","id","updateData","prevData","handleCheckboxChange","checked","handleTextChange","label","onSubmit","event","_params$fields_attrib","promises","params","file","catch","console","Promise","all","then","preventDefault","className","accept","disabled","labelText","defaultMessage","birthdays","date","accountLocation","accountWebsite","autoComplete","followRequests","hint","hide","bots","profileDirectory","emailList","profileFields","values","count","onAddItem","oldFields","concat","onRemoveItem","splice","component","maxItems","to","theme"],"sourceRoot":""}