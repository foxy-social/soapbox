{"version":3,"file":"packs/js/features/hashtag_timeline-990563366c705b71aa0c.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/features/hashtag-timeline/index.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _toConsumableArray from\"@babel/runtime/helpers/esm/toConsumableArray\";import\"core-js/modules/es.array.push.js\";import\"core-js/modules/es.array.map.js\";import\"core-js/modules/es.array.concat.js\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.array.includes.js\";import\"core-js/modules/es.string.includes.js\";import React,{useEffect,useRef}from'react';import{useIntl,defineMessages,FormattedMessage}from'react-intl';import{connectHashtagStream}from'soapbox/actions/streaming';import{fetchHashtag,followHashtag,unfollowHashtag}from'soapbox/actions/tags';import{expandHashtagTimeline,clearTimeline}from'soapbox/actions/timelines';import List,{ListItem}from'soapbox/components/list';import{Column,Toggle}from'soapbox/components/ui';import Timeline from'soapbox/features/ui/components/timeline';import{useAppDispatch,useAppSelector,useFeatures}from'soapbox/hooks';var messages=defineMessages({any:{\"id\":\"hashtag.column_header.tag_mode.any\",\"defaultMessage\":\"or {additional}\"},all:{\"id\":\"hashtag.column_header.tag_mode.all\",\"defaultMessage\":\"and {additional}\"},none:{\"id\":\"hashtag.column_header.tag_mode.none\",\"defaultMessage\":\"without {additional}\"},empty:{\"id\":\"empty_column.hashtag\",\"defaultMessage\":\"There is nothing in this hashtag yet.\"}});export var HashtagTimeline=function HashtagTimeline(_ref){var params=_ref.params;var intl=useIntl();var id=(params===null||params===void 0?void 0:params.id)||'';var tags=(params===null||params===void 0?void 0:params.tags)||{any:[],all:[],none:[]};var features=useFeatures();var dispatch=useAppDispatch();var disconnects=useRef([]);var tag=useAppSelector(function(state){return state.tags.get(id);});var next=useAppSelector(function(state){var _state$timelines$get;return(_state$timelines$get=state.timelines.get(\"hashtag:\".concat(id)))===null||_state$timelines$get===void 0?void 0:_state$timelines$get.next;});// Mastodon supports displaying results from multiple hashtags.\n// https://github.com/mastodon/mastodon/issues/6359\nvar title=function title(){var title=[\"#\".concat(id)];if(additionalFor('any')){title.push(' ',intl.formatMessage(messages.any,{additional:additionalFor('any')}));}if(additionalFor('all')){title.push(' ',intl.formatMessage(messages.any,{additional:additionalFor('all')}));}if(additionalFor('none')){title.push(' ',intl.formatMessage(messages.any,{additional:additionalFor('none')}));}return title.join('');};var additionalFor=function additionalFor(mode){if(tags&&(tags[mode]||[]).length>0){return tags[mode].map(function(tag){return tag.value;}).join('/');}else{return'';}};var subscribe=function subscribe(){var any=tags.any.map(function(tag){return tag.value;});var all=tags.all.map(function(tag){return tag.value;});var none=tags.none.map(function(tag){return tag.value;});[id].concat(_toConsumableArray(any)).map(function(tag){disconnects.current.push(dispatch(connectHashtagStream(id,tag,function(status){var tags=status.tags.map(function(tag){return tag.name;});return all.filter(function(tag){return tags.includes(tag);}).length===all.length&&none.filter(function(tag){return tags.includes(tag);}).length===0;})));});};var unsubscribe=function unsubscribe(){disconnects.current.map(function(disconnect){return disconnect();});disconnects.current=[];};var handleLoadMore=function handleLoadMore(maxId){dispatch(expandHashtagTimeline(id,{url:next,maxId:maxId,tags:tags}));};var handleFollow=function handleFollow(){if(tag!==null&&tag!==void 0&&tag.following){dispatch(unfollowHashtag(id));}else{dispatch(followHashtag(id));}};useEffect(function(){subscribe();dispatch(expandHashtagTimeline(id,{tags:tags}));dispatch(fetchHashtag(id));return function(){unsubscribe();};},[]);useEffect(function(){unsubscribe();subscribe();dispatch(clearTimeline(\"hashtag:\".concat(id)));dispatch(expandHashtagTimeline(id,{tags:tags}));},[id]);return/*#__PURE__*/_jsx(Column,{bodyClassName:\"space-y-3\",label:title(),transparent:true},void 0,features.followHashtags&&/*#__PURE__*/_jsx(List,{},void 0,/*#__PURE__*/_jsx(ListItem,{label:/*#__PURE__*/_jsx(FormattedMessage,{id:\"hashtag.follow\",defaultMessage:\"Follow hashtag\"})},void 0,/*#__PURE__*/_jsx(Toggle,{checked:tag===null||tag===void 0?void 0:tag.following,onChange:handleFollow}))),/*#__PURE__*/_jsx(Timeline,{scrollKey:\"hashtag_timeline\",timelineId:\"hashtag:\".concat(id),onLoadMore:handleLoadMore,emptyMessage:intl.formatMessage(messages.empty),divideType:\"space\"}));};export default HashtagTimeline;"],"names":["messages","any","all","none","empty","HashtagTimeline","_ref","title","params","intl","id","tags","features","dispatch","disconnects","useRef","tag","state","get","next","_state$timelines$get","timelines","concat","additionalFor","mode","length","map","value","join","subscribe","current","push","status","name","filter","includes","unsubscribe","disconnect","useEffect","bodyClassName","label","formatMessage","additional","transparent","followHashtags","defaultMessage","checked","following","onChange","scrollKey","timelineId","onLoadMore","maxId","url","emptyMessage","divideType"],"sourceRoot":""}