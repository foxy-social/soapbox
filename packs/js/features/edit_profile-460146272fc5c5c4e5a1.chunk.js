"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[34],{1172:function(e,t,l){l.r(t),l(11),l(12),l(16),l(7),l(18),l(19),l(10);var i=l(1203),o=l(2111),a=l(1202),s=l(1188),d=l(2109),n=(l(0),l(25),l(9),l(75),l(4),l(14),l(20),l(17),l(8),l(55),l(1)),r=l(2121),c=l(2122),f=l(2142),u=l(51),p=l(148),_=l(1554),h=l(100),b=l(2),v=l(3),m=l(828),Z=l(34),g=l(111),w=l(829),y=l(830);function M(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,i)}return l}function k(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?M(Object(l),!0).forEach((function(t){(0,s.Z)(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):M(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}var x=function(e){return e&&(0,g.NF)(e)?void 0:e},C=(0,r.vU)({heading:{id:"column.edit_profile",defaultMessage:"Edit profile"},header:{id:"edit_profile.header",defaultMessage:"Edit Profile"},metaFieldLabel:{id:"edit_profile.fields.meta_fields.label_placeholder",defaultMessage:"Label"},metaFieldContent:{id:"edit_profile.fields.meta_fields.content_placeholder",defaultMessage:"Content"},success:{id:"edit_profile.success",defaultMessage:"Profile saved!"},error:{id:"edit_profile.error",defaultMessage:"Profile update failed"},bioPlaceholder:{id:"edit_profile.fields.bio_placeholder",defaultMessage:"Tell us about yourself."},displayNamePlaceholder:{id:"edit_profile.fields.display_name_placeholder",defaultMessage:"Name"},websitePlaceholder:{id:"edit_profile.fields.website_placeholder",defaultMessage:"Display a Link"},locationPlaceholder:{id:"edit_profile.fields.location_placeholder",defaultMessage:"Location"},cancel:{id:"common.cancel",defaultMessage:"Cancel"}}),P=function(e){var t=e.value,l=e.onChange,i=(0,c.Z)(),o=function(e){return function(i){l(k(k({},t),{},(0,s.Z)({},e,i.currentTarget.value)))}};return(0,a.Z)(b.Ug,{space:2,grow:!0},void 0,(0,a.Z)(b.II,{type:"text",outerClassName:"w-2/5 grow",value:t.name,onChange:o("name"),placeholder:i.formatMessage(C.metaFieldLabel)}),(0,a.Z)(b.II,{type:"text",outerClassName:"w-3/5 grow",value:t.value,onChange:o("value"),placeholder:i.formatMessage(C.metaFieldContent)}))};t.default=function(){var e,t,l=(0,c.Z)(),r=(0,v.TL)(),M=(0,v.fz)(),O=(0,v.Tr)().account,D=(0,v.hz)(),I=M.pleroma.getIn(["metadata","fields_limits","max_fields"],4),j=null===(e=(0,v.CG)((function(e){return e.instance.configuration.getIn(["media_attachments","supported_mime_types"])})))||void 0===e?void 0:e.filter((function(e){return e.startsWith("image/")})).toArray().join(","),T=(0,n.useState)(!1),L=(0,o.Z)(T,2),N=L[0],S=L[1],E=(0,n.useState)({}),H=(0,o.Z)(E,2),B=H[0],F=H[1],z=(0,n.useState)(!1),W=(0,o.Z)(z,2),A=W[0],R=W[1],U=(0,m.XB)({maxPixels:16e4,preview:(t=null==O?void 0:O.avatar,t&&(0,g.z_)(t)?void 0:t)}),q=(0,m.XB)({maxPixels:2073600,preview:x(null==O?void 0:O.header)});(0,n.useEffect)((function(){if(O){var e,t,l=function(e){var t,l,i,o,a,s,n,r,c,f,u=(f=e.pleroma,Boolean((null==f?void 0:f.hide_followers)&&(null==f?void 0:f.hide_follows)&&(null==f?void 0:f.hide_followers_count)&&(null==f?void 0:f.hide_follows_count)));return{discoverable:e.discoverable,bot:e.bot,display_name:e.display_name,note:null!==(t=null===(l=e.source)||void 0===l?void 0:l.note)&&void 0!==t?t:"",locked:e.locked,fields_attributes:(0,d.Z)(null!==(i=null===(o=e.source)||void 0===o?void 0:o.fields)&&void 0!==i?i:[]),stranger_notifications:!0===(null===(a=e.pleroma)||void 0===a||null===(s=a.notification_settings)||void 0===s?void 0:s.block_from_strangers),accepts_email_list:!0===(null===(n=e.pleroma)||void 0===n?void 0:n.accepts_email_list),hide_followers:u,hide_follows:u,hide_followers_count:u,hide_follows_count:u,website:e.website,location:e.location,birthday:null!==(r=null===(c=e.pleroma)||void 0===c?void 0:c.birthday)&&void 0!==r?r:void 0}}(O),i=!0===(null===(e=O.pleroma)||void 0===e||null===(t=e.notification_settings)||void 0===t?void 0:t.block_from_strangers);F(l),R(i)}}),[null==O?void 0:O.id]);var X=function(e,t){F((function(l){return k(k({},l),{},(0,s.Z)({},e,t))}))},G=function(e){return function(t){X(e,t.target.checked)}},Q=function(e){return function(t){X(e,t.target.value)}};return(0,a.Z)(b.sg,{label:l.formatMessage(C.header)},void 0,(0,a.Z)(b.l0,{onSubmit:function(e){var t,i=[],o=k({},B);0===(null===(t=o.fields_attributes)||void 0===t?void 0:t.length)&&(o.fields_attributes=[{name:"",value:""}]),void 0!==q.file&&(o.header=q.file||""),void 0!==U.file&&(o.avatar=U.file||""),i.push(r((0,p.sQ)(o,!0))),D.muteStrangers&&i.push(r((0,u.lU)({block_from_strangers:A})).catch(console.error)),S(!0),Promise.all(i).then((function(){S(!1),Z.Z.success(l.formatMessage(C.success))})).catch((function(){S(!1),Z.Z.error(l.formatMessage(C.error))})),e.preventDefault()}},void 0,(0,a.Z)("div",{className:"relative mb-12 flex"},void 0,n.createElement(y.Z,(0,i.Z)({accept:j,disabled:N},q)),n.createElement(w.Z,(0,i.Z)({className:"!sm:left-6 !left-4 !translate-x-0",accept:j,disabled:N},U))),(0,a.Z)(b.cw,{labelText:(0,a.Z)(f.Z,{id:"edit_profile.fields.display_name_label",defaultMessage:"Display name"})},void 0,(0,a.Z)(b.II,{type:"text",value:B.display_name,onChange:Q("display_name"),placeholder:l.formatMessage(C.displayNamePlaceholder)})),D.birthdays&&(0,a.Z)(b.cw,{labelText:(0,a.Z)(f.Z,{id:"edit_profile.fields.birthday_label",defaultMessage:"Birthday"})},void 0,(0,a.Z)(_.Z,{value:B.birthday,onChange:function(e){X("birthday",e)}})),D.accountLocation&&(0,a.Z)(b.cw,{labelText:(0,a.Z)(f.Z,{id:"edit_profile.fields.location_label",defaultMessage:"Location"})},void 0,(0,a.Z)(b.II,{type:"text",value:B.location,onChange:Q("location"),placeholder:l.formatMessage(C.locationPlaceholder)})),D.accountWebsite&&(0,a.Z)(b.cw,{labelText:(0,a.Z)(f.Z,{id:"edit_profile.fields.website_label",defaultMessage:"Website"})},void 0,(0,a.Z)(b.II,{type:"text",value:B.website,onChange:Q("website"),placeholder:l.formatMessage(C.websitePlaceholder)})),(0,a.Z)(b.cw,{labelText:(0,a.Z)(f.Z,{id:"edit_profile.fields.bio_label",defaultMessage:"Bio"})},void 0,(0,a.Z)(b.gx,{value:B.note,onChange:Q("note"),autoComplete:"off",placeholder:l.formatMessage(C.bioPlaceholder)})),(0,a.Z)(h.Z,{},void 0,D.followRequests&&(0,a.Z)(h.H,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.locked_label",defaultMessage:"Lock account"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.locked",defaultMessage:"Requires you to manually approve followers"})},void 0,(0,a.Z)(b.ZD,{checked:B.locked,onChange:G("locked")})),D.hideNetwork&&(0,a.Z)(h.H,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.hide_network_label",defaultMessage:"Hide network"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.hide_network",defaultMessage:"Who you follow and who follows you will not be shown on your profile"})},void 0,(0,a.Z)(b.ZD,{checked:!!O&&B.hide_followers&&B.hide_follows&&B.hide_followers_count&&B.hide_follows_count,onChange:function(e){var t=e.target.checked;F((function(e){return k(k({},e),{},{hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t})}))}})),D.bots&&(0,a.Z)(h.H,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.bot_label",defaultMessage:"This is a bot account"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.bot",defaultMessage:"This account mainly performs automated actions and might not be monitored"})},void 0,(0,a.Z)(b.ZD,{checked:B.bot,onChange:G("bot")})),D.muteStrangers&&(0,a.Z)(h.H,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.stranger_notifications_label",defaultMessage:"Block notifications from strangers"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.stranger_notifications",defaultMessage:"Only show notifications from people you follow"})},void 0,(0,a.Z)(b.ZD,{checked:A,onChange:function(e){return R(e.target.checked)}})),D.profileDirectory&&(0,a.Z)(h.H,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.discoverable_label",defaultMessage:"Allow account discovery"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.discoverable",defaultMessage:"Display account in profile directory and allow indexing by external services"})},void 0,(0,a.Z)(b.ZD,{checked:B.discoverable,onChange:G("discoverable")})),D.emailList&&(0,a.Z)(h.H,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.accepts_email_list_label",defaultMessage:"Subscribe to newsletter"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.accepts_email_list",defaultMessage:"Opt-in to news and marketing updates."})},void 0,(0,a.Z)(b.ZD,{checked:B.accepts_email_list,onChange:G("accepts_email_list")}))),D.profileFields&&(0,a.Z)(b.uc,{label:(0,a.Z)(f.Z,{id:"edit_profile.fields.meta_fields_label",defaultMessage:"Profile fields"}),hint:(0,a.Z)(f.Z,{id:"edit_profile.hints.meta_fields",defaultMessage:"You can have up to {count, plural, one {# custom field} other {# custom fields}} displayed on your profile.",values:{count:I}}),values:B.fields_attributes||[],onChange:function(e){X("fields_attributes",e)},onAddItem:function(){var e=B.fields_attributes||[],t=[].concat((0,d.Z)(e),[{name:"",value:""}]);X("fields_attributes",t)},onRemoveItem:function(e){var t=B.fields_attributes||[],l=(0,d.Z)(t);l.splice(e,1),X("fields_attributes",l)},component:P,maxItems:I}),(0,a.Z)(b.iN,{},void 0,(0,a.Z)(b.zx,{to:"/settings",theme:"tertiary"},void 0,l.formatMessage(C.cancel)),(0,a.Z)(b.zx,{theme:"primary",type:"submit",disabled:N},void 0,(0,a.Z)(f.Z,{id:"edit_profile.save",defaultMessage:"Save"})))))}}}]);
//# sourceMappingURL=edit_profile-460146272fc5c5c4e5a1.chunk.js.map