{"version":3,"file":"packs/js/features/account_gallery-21f63305e14962c7d7f1.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/features/account-gallery/index.tsx","webpack://soapbox/./app/soapbox/features/ui/components/profile-media-panel.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.find-index.js\";import\"core-js/modules/es.array.map.js\";import\"core-js/modules/es.array.concat.js\";import React,{useEffect,useRef}from'react';import{FormattedMessage}from'react-intl';import{useParams}from'react-router-dom';import{openModal}from'soapbox/actions/modals';import{expandAccountMediaTimeline}from'soapbox/actions/timelines';import{useAccountLookup}from'soapbox/api/hooks';import LoadMore from'soapbox/components/load-more';import MissingIndicator from'soapbox/components/missing-indicator';import{Column,Spinner}from'soapbox/components/ui';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import{getAccountGallery}from'soapbox/selectors';import MediaItem from'./components/media-item';var LoadMoreMedia=function LoadMoreMedia(_ref){var maxId=_ref.maxId,onLoadMore=_ref.onLoadMore;var handleLoadMore=function handleLoadMore(){onLoadMore(maxId);};return/*#__PURE__*/_jsx(LoadMore,{onClick:handleLoadMore});};var AccountGallery=function AccountGallery(){var dispatch=useAppDispatch();var _useParams=useParams(),username=_useParams.username;var _useAccountLookup=useAccountLookup(username,{withRelationship:true}),account=_useAccountLookup.account,accountLoading=_useAccountLookup.isLoading,isUnavailable=_useAccountLookup.isUnavailable;var attachments=useAppSelector(function(state){return getAccountGallery(state,account.id);});var isLoading=useAppSelector(function(state){var _state$timelines$get;return(_state$timelines$get=state.timelines.get(\"account:\".concat(account===null||account===void 0?void 0:account.id,\":media\")))===null||_state$timelines$get===void 0?void 0:_state$timelines$get.isLoading;});var hasMore=useAppSelector(function(state){var _state$timelines$get2;return(_state$timelines$get2=state.timelines.get(\"account:\".concat(account===null||account===void 0?void 0:account.id,\":media\")))===null||_state$timelines$get2===void 0?void 0:_state$timelines$get2.hasMore;});var next=useAppSelector(function(state){var _state$timelines$get3;return(_state$timelines$get3=state.timelines.get(\"account:\".concat(account===null||account===void 0?void 0:account.id,\":media\")))===null||_state$timelines$get3===void 0?void 0:_state$timelines$get3.next;});var node=useRef(null);var handleScrollToBottom=function handleScrollToBottom(){if(hasMore){handleLoadMore(attachments.size>0?attachments.last().status.id:undefined);}};var handleLoadMore=function handleLoadMore(maxId){if(account){dispatch(expandAccountMediaTimeline(account.id,{url:next,maxId:maxId}));}};var handleLoadOlder=function handleLoadOlder(e){e.preventDefault();handleScrollToBottom();};var handleOpenMedia=function handleOpenMedia(attachment){if(attachment.type==='video'){dispatch(openModal('VIDEO',{media:attachment,status:attachment.status,account:attachment.account}));}else{var media=attachment.status.media_attachments;var index=media.findIndex(function(x){return x.id===attachment.id;});dispatch(openModal('MEDIA',{media:media,index:index,status:attachment.status}));}};useEffect(function(){if(account){dispatch(expandAccountMediaTimeline(account.id));}},[account===null||account===void 0?void 0:account.id]);if(accountLoading||!attachments&&isLoading){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(Spinner,{}));}if(!account){return/*#__PURE__*/_jsx(MissingIndicator,{});}var loadOlder=null;if(hasMore&&!(isLoading&&attachments.size===0)){loadOlder=/*#__PURE__*/_jsx(LoadMore,{className:\"my-auto\",visible:!isLoading,onClick:handleLoadOlder});}if(isUnavailable){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"empty-column-indicator\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.account_unavailable\",defaultMessage:\"Profile unavailable\"})));}return/*#__PURE__*/_jsx(Column,{label:\"@\".concat(account.acct),transparent:true,withHeader:false},void 0,/*#__PURE__*/React.createElement(\"div\",{role:\"feed\",className:\"grid grid-cols-2 gap-2 sm:grid-cols-3\",ref:node},attachments.map(function(attachment,index){var _attachments$get,_attachments$get2;return attachment===null?/*#__PURE__*/_jsx(LoadMoreMedia,{maxId:index>0?((_attachments$get2=attachments.get(index-1))===null||_attachments$get2===void 0?void 0:_attachments$get2.id)||null:null,onLoadMore:handleLoadMore},'more:'+((_attachments$get=attachments.get(index+1))===null||_attachments$get===void 0?void 0:_attachments$get.id)):/*#__PURE__*/_jsx(MediaItem,{attachment:attachment,onOpenMedia:handleOpenMedia},\"\".concat(attachment.status.id,\"+\").concat(attachment.id));}),!isLoading&&attachments.size===0&&/*#__PURE__*/_jsx(\"div\",{className:\"empty-column-indicator col-span-2 sm:col-span-3\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_gallery.none\",defaultMessage:\"No media to show.\"})),loadOlder),isLoading&&attachments.size===0&&/*#__PURE__*/_jsx(\"div\",{className:\"slist__append\"},void 0,/*#__PURE__*/_jsx(Spinner,{})));};export default AccountGallery;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import\"core-js/modules/es.array.find-index.js\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.array.slice.js\";import\"core-js/modules/es.array.map.js\";import\"core-js/modules/es.array.concat.js\";import{List as ImmutableList}from'immutable';import React,{useState,useEffect}from'react';import{FormattedMessage}from'react-intl';import{openModal}from'soapbox/actions/modals';import{expandAccountMediaTimeline}from'soapbox/actions/timelines';import{Spinner,Text,Widget}from'soapbox/components/ui';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import{getAccountGallery}from'soapbox/selectors';import MediaItem from'../../account-gallery/components/media-item';var ProfileMediaPanel=function ProfileMediaPanel(_ref){var account=_ref.account;var dispatch=useAppDispatch();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var attachments=useAppSelector(function(state){return account?getAccountGallery(state,account===null||account===void 0?void 0:account.id):ImmutableList();});var handleOpenMedia=function handleOpenMedia(attachment){if(attachment.type==='video'){dispatch(openModal('VIDEO',{media:attachment,status:attachment.status}));}else{var media=attachment.getIn(['status','media_attachments']);var index=media.findIndex(function(x){return x.id===attachment.id;});dispatch(openModal('MEDIA',{media:media,index:index,status:attachment.status}));}};useEffect(function(){setLoading(true);if(account){dispatch(expandAccountMediaTimeline(account.id))// @ts-ignore yes it does\n.then(function(){return setLoading(false);}).catch(function(){});}},[account===null||account===void 0?void 0:account.id]);var renderAttachments=function renderAttachments(){var publicAttachments=attachments.filter(function(attachment){return attachment.getIn(['status','visibility'])==='public';});var nineAttachments=publicAttachments.slice(0,9);if(!nineAttachments.isEmpty()){return/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-3 gap-1\"},void 0,nineAttachments.map(function(attachment,_index){return/*#__PURE__*/_jsx(MediaItem,{attachment:attachment,onOpenMedia:handleOpenMedia},\"\".concat(attachment.getIn(['status','id']),\"+\").concat(attachment.id));}));}else{return/*#__PURE__*/_jsx(Text,{size:\"sm\",theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"media_panel.empty_message\",defaultMessage:\"No media found.\"}));}};return/*#__PURE__*/_jsx(Widget,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"media_panel.title\",defaultMessage:\"Media\"})},void 0,account&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full\"},void 0,loading?/*#__PURE__*/_jsx(Spinner,{}):renderAttachments()));};export default ProfileMediaPanel;"],"names":["LoadMoreMedia","_ref","maxId","onLoadMore","onClick","dispatch","username","_useAccountLookup","withRelationship","account","accountLoading","isLoading","isUnavailable","attachments","state","id","_state$timelines$get","timelines","get","concat","hasMore","_state$timelines$get2","next","_state$timelines$get3","node","useRef","handleLoadMore","url","handleOpenMedia","attachment","type","media","status","media_attachments","index","findIndex","x","useEffect","loadOlder","size","className","visible","e","preventDefault","last","undefined","defaultMessage","label","acct","transparent","withHeader","role","ref","map","_attachments$get","_attachments$get2","onOpenMedia","nineAttachments","_useState","useState","_useState2","loading","setLoading","getIn","then","catch","title","filter","slice","isEmpty","theme","_index"],"sourceRoot":""}